<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>JPO vÃ½jezdy â€“ dashboard</title>
  <link rel="stylesheet" href="styles.css" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

  <!-- MarkerCluster -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css">
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="title">JPO vÃ½jezdy â€” dashboard</div>
      <div class="subtitle">Mapa â€¢ aktivnÃ­/ukonÄenÃ© â€¢ statistiky â€¢ export (data posÃ­lÃ¡ ESP32)</div>
    </div>

    <div class="actions">
      <button id="btnRefresh" class="btn">Obnovit</button>
      <a class="btn ghost" href="/api/export.csv" target="_blank">Export CSV</a>
      <button id="btnPrint" class="btn ghost">PDF / tisk</button>
      <span id="statusPill" class="pill">â€¦</span>
    </div>
  </header>

  <main class="grid">
    <!-- MAP -->
    <section class="card mapCard">
      <div class="cardHead">
        <div class="h">Mapa vÃ½jezdÅ¯</div>
        <div class="filters">
          <button class="chip" data-kind="all">vÅ¡e</button>
          <button class="chip" data-kind="pozar">ğŸ”¥ poÅ¾Ã¡r</button>
          <button class="chip" data-kind="nehoda">ğŸš— nehoda</button>
          <button class="chip" data-kind="technicka">ğŸ›  technickÃ¡</button>
          <button class="chip" data-kind="zachrana">ğŸ§ zÃ¡chrana</button>
          <button class="chip" data-kind="jine">â“ jinÃ©</button>
          <span class="sep"></span>
          <button class="chip chipOn" data-active="active">ğŸŸ¢ aktivnÃ­</button>
          <button class="chip" data-active="closed">âšª ukonÄenÃ©</button>
          <button class="chip" data-active="all">ğŸŒ“ vÅ¡e</button>
        </div>
      </div>
      <div id="map"></div>
    </section>

    <!-- RIGHT STATS -->
    <section class="card">
      <div class="cardHead">
        <div class="h">Statistika (30 dnÃ­)</div>
      </div>
      <div class="cardBody">
        <canvas id="chartByDay" height="120"></canvas>
      </div>
    </section>

    <section class="card">
      <div class="cardHead">
        <div class="h">AktivnÃ­ vs ukonÄenÃ©</div>
      </div>
      <div class="cardBody kpiRow">
        <div class="kpi">
          <div class="kpiLabel">AktivnÃ­</div>
          <div id="kpiActive" class="kpiValue">â€”</div>
        </div>
        <div class="kpi">
          <div class="kpiLabel">UkonÄenÃ©</div>
          <div id="kpiClosed" class="kpiValue">â€”</div>
        </div>
      </div>
    </section>

    <section class="card">
      <div class="cardHead">
        <div class="h">NejvÃ­c vÃ½jezdÅ¯ ve mÄ›stÄ›</div>
        <div class="muted">Top mÄ›sto (poÄet)</div>
      </div>
      <div class="cardBody">
        <div id="topCity" class="bigLine">â€”</div>
      </div>
    </section>

    <section class="card">
      <div class="cardHead">
        <div class="h">Å½ebÅ™Ã­Äek mÄ›st</div>
        <div class="muted">Top 10</div>
      </div>
      <div class="cardBody">
        <div id="topCities" class="list"></div>
      </div>
    </section>

    <section class="card">
      <div class="cardHead">
        <div class="h">NejdelÅ¡Ã­ zÃ¡sahy</div>
        <div class="muted">Top 10 podle dÃ©lky</div>
      </div>
      <div class="cardBody">
        <div id="longest" class="list"></div>
      </div>
    </section>

    <!-- TABLE -->
    <section class="card tableCard">
      <div class="cardHead">
        <div class="h">PÅ™ehled udÃ¡lostÃ­</div>
        <div class="muted">klikni na odkaz â†’ detail</div>
      </div>
      <div class="cardBody">
        <div id="tableWrap"></div>
      </div>
    </section>

  </main>

  <script src="app.js"></script>
</body>
</html>
